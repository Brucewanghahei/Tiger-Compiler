fun decrement_to_zero r = if !r < 0 then r := 0 else while !r >= 0 do r := !r - 1